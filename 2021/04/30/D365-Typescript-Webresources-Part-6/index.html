<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="Application Insights, a feature of Azure Monitor, is an extensible Application Performance Management (APM) service for developers and DevOps professionals. Use it to monitor your live applications. I">
<meta property="og:type" content="article">
<meta property="og:title" content="D365 TypeScript Web Resources - Part 6 - Application Insights">
<meta property="og:url" content="http://www.oliverflint.co.uk/2021/04/30/D365-Typescript-Webresources-Part-6/index.html">
<meta property="og:site_name" content="A Blog by Oliver Flint">
<meta property="og:description" content="Application Insights, a feature of Azure Monitor, is an extensible Application Performance Management (APM) service for developers and DevOps professionals. Use it to monitor your live applications. I">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://www.oliverflint.co.uk/2021/04/30/D365-Typescript-Webresources-Part-6/log.png">
<meta property="og:image" content="http://www.oliverflint.co.uk/2021/04/30/D365-Typescript-Webresources-Part-6/detail.png">
<meta property="article:published_time" content="2021-04-30T22:00:00.000Z">
<meta property="article:modified_time" content="2026-01-27T19:14:05.896Z">
<meta property="article:author" content="Oliver Flint">
<meta property="article:tag" content="D365">
<meta property="article:tag" content="JavaScript">
<meta property="article:tag" content="TypeScript">
<meta property="article:tag" content="Web Resources">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.oliverflint.co.uk/2021/04/30/D365-Typescript-Webresources-Part-6/log.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>D365 TypeScript Web Resources - Part 6 - Application Insights</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
<meta name="generator" content="Hexo 8.1.1"><link rel="alternate" href="/rss.xml" title="A Blog by Oliver Flint" type="application/rss+xml">
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/categories/">Categories</a></li>
         
          <li><a href="/archives/">Archive</a></li>
         
          <li><a href="/Me/">Me</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2022/12/06/Deleting-stale-branches-in-Azure-DevOps-Git-Repositories/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2021/01/22/D365-Typescript-Webresources-Part-5/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://www.oliverflint.co.uk/2021/04/30/D365-Typescript-Webresources-Part-6/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://www.oliverflint.co.uk/2021/04/30/D365-Typescript-Webresources-Part-6/&text=D365 TypeScript Web Resources - Part 6 - Application Insights"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://www.oliverflint.co.uk/2021/04/30/D365-Typescript-Webresources-Part-6/&title=D365 TypeScript Web Resources - Part 6 - Application Insights"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://www.oliverflint.co.uk/2021/04/30/D365-Typescript-Webresources-Part-6/&is_video=false&description=D365 TypeScript Web Resources - Part 6 - Application Insights"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=D365 TypeScript Web Resources - Part 6 - Application Insights&body=Check out this article: http://www.oliverflint.co.uk/2021/04/30/D365-Typescript-Webresources-Part-6/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://www.oliverflint.co.uk/2021/04/30/D365-Typescript-Webresources-Part-6/&title=D365 TypeScript Web Resources - Part 6 - Application Insights"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://www.oliverflint.co.uk/2021/04/30/D365-Typescript-Webresources-Part-6/&title=D365 TypeScript Web Resources - Part 6 - Application Insights"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://www.oliverflint.co.uk/2021/04/30/D365-Typescript-Webresources-Part-6/&title=D365 TypeScript Web Resources - Part 6 - Application Insights"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://www.oliverflint.co.uk/2021/04/30/D365-Typescript-Webresources-Part-6/&title=D365 TypeScript Web Resources - Part 6 - Application Insights"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://www.oliverflint.co.uk/2021/04/30/D365-Typescript-Webresources-Part-6/&name=D365 TypeScript Web Resources - Part 6 - Application Insights&description=Application Insights, a feature of Azure Monitor, is an extensible Application Performance Management (APM) service for developers and DevOps professionals. Use it to monitor your live applications. In this post I&#39;ll go though the steps required to set it up in your TypeScript Webresources project."><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://www.oliverflint.co.uk/2021/04/30/D365-Typescript-Webresources-Part-6/&t=D365 TypeScript Web Resources - Part 6 - Application Insights"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Application-Insights"><span class="toc-number">1.</span> <span class="toc-text">Application Insights</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#What-is-Application-Insights"><span class="toc-number">1.1.</span> <span class="toc-text">What is Application Insights?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Setup"><span class="toc-number">1.2.</span> <span class="toc-text">Setup</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#The-Code"><span class="toc-number">1.3.</span> <span class="toc-text">The Code</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Telemetry-Initializer"><span class="toc-number">1.4.</span> <span class="toc-text">Telemetry Initializer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#What%E2%80%99s-it-look-like"><span class="toc-number">1.5.</span> <span class="toc-text">What’s it look like!?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#That%E2%80%99s-all-folks"><span class="toc-number">1.6.</span> <span class="toc-text">That’s all folks!</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        D365 TypeScript Web Resources - Part 6 - Application Insights
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Oliver Flint</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2021-04-30T22:00:00.000Z" itemprop="datePublished">2021-04-30</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/D365-TypeScript/">D365 TypeScript</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/D365/" rel="tag">D365</a>, <a class="tag-link-link" href="/tags/JavaScript/" rel="tag">JavaScript</a>, <a class="tag-link-link" href="/tags/TypeScript/" rel="tag">TypeScript</a>, <a class="tag-link-link" href="/tags/Web-Resources/" rel="tag">Web Resources</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>Before you get stuck into this make sure you’ve checked out any previous parts to the <a href="/categories/D365-TypeScript/">series</a>. Each part in this series follows on from the previous, so you may need to grab the code from the previous part if you haven’t been following.</p>
<h1 id="Application-Insights"><a href="#Application-Insights" class="headerlink" title="Application Insights"></a>Application Insights</h1><h2 id="What-is-Application-Insights"><a href="#What-is-Application-Insights" class="headerlink" title="What is Application Insights?"></a>What is Application Insights?</h2><blockquote>
<p>Application Insights, a feature of Azure Monitor, is an extensible Application Performance Management (APM) service for developers and DevOps professionals. Use it to monitor your live applications. It will automatically detect performance anomalies, and includes powerful analytics tools to help you diagnose issues and to understand what users actually do with your app. It’s designed to help you continuously improve performance and usability. It works for apps on a wide variety of platforms including .NET, Node.js, Java, and Python hosted on-premises, hybrid, or any public cloud. It integrates with your DevOps process, and has connection points to a variety of development tools. It can monitor and analyze telemetry from mobile apps by integrating with Visual Studio App Center.</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/azure-monitor/app/app-insights-overview">https://docs.microsoft.com/en-us/azure/azure-monitor/app/app-insights-overview</a></p>
<h2 id="Setup"><a href="#Setup" class="headerlink" title="Setup"></a>Setup</h2><p>First lets install the npm package(s):</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @microsoft/applicationinsights-web</span><br></pre></td></tr></table></figure>

<p>Next we need to setup Application Insights in Azure. If you don’t have an azure subscription you can signup for a free trial <a target="_blank" rel="noopener" href="https://azure.microsoft.com/en-gb/free/">here</a>.</p>
<p>Create an Application Insights Resource in Azure by following the steps <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/azure/azure-monitor/app/create-new-resource">here</a> (you can stop at the bit where you copy the instrumentation key)</p>
<p>Now you have an app insights resource and the instrumentation key we are ready to go!</p>
<h2 id="The-Code"><a href="#The-Code" class="headerlink" title="The Code"></a>The Code</h2><p>First we’ll put together a little module that encapsulates a minimal setup of Application Insights API</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ApplicationInsights</span> &#125; <span class="keyword">from</span> <span class="string">&quot;@microsoft/applicationinsights-web&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">init</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> appins = <span class="keyword">new</span> <span class="title class_">ApplicationInsights</span>(&#123;</span><br><span class="line">    <span class="attr">config</span>: &#123;</span><br><span class="line">      <span class="attr">instrumentationKey</span>: <span class="string">&quot;YOUR_KEY&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">  appins.<span class="title function_">loadAppInsights</span>();</span><br><span class="line">  (<span class="variable language_">window</span> <span class="keyword">as</span> <span class="built_in">any</span>).<span class="property">d365ts_appinsights</span> = appins;</span><br><span class="line">  <span class="keyword">return</span> appins;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> appInsights = (<span class="variable language_">window</span> <span class="keyword">as</span> <span class="built_in">any</span>).<span class="property">d365ts_appinsights</span></span><br><span class="line">  ? ((<span class="variable language_">window</span> <span class="keyword">as</span> <span class="built_in">any</span>).<span class="property">d365ts_appinsights</span> <span class="keyword">as</span> <span class="title class_">ApplicationInsights</span>)</span><br><span class="line">  : <span class="title function_">init</span>();</span><br></pre></td></tr></table></figure>

<p>Now, we can simply import our module</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; appInsights &#125; <span class="keyword">from</span> <span class="string">&quot;./appinsights&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>And start tracking page views</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">appInsights.<span class="title function_">trackPageView</span>();</span><br></pre></td></tr></table></figure>

<p>Or track exceptions</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">appInsights.<span class="title function_">trackException</span>(&#123;</span><br><span class="line">  <span class="attr">exception</span>: &#123; <span class="attr">message</span>: <span class="string">&quot;This is an error&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;Onload Error&quot;</span> &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>There are also other tracking functions <code>trackMetric</code>, <code>trackEvent</code>, <code>trackTrace</code>, etc.</p>
<h2 id="Telemetry-Initializer"><a href="#Telemetry-Initializer" class="headerlink" title="Telemetry Initializer"></a>Telemetry Initializer</h2><p>One of the great things about the telemetry initializer is that it allow you to define some custom data&#x2F;properties to include when tracking</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">appins.<span class="title function_">addTelemetryInitializer</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> globalCtx = <span class="title class_">Xrm</span>.<span class="property">Utility</span>.<span class="title function_">getGlobalContext</span>();</span><br><span class="line">  item.<span class="property">data</span>.<span class="property">Username</span> = globalCtx.<span class="property">userSettings</span>?.<span class="property">userName</span>;</span><br><span class="line">  item.<span class="property">data</span>.<span class="property">UserId</span> = globalCtx.<span class="property">userSettings</span>?.<span class="property">userId</span>;</span><br><span class="line">  item.<span class="property">data</span>.<span class="property">SecurityRoles</span> = (globalCtx.<span class="property">userSettings</span>?.<span class="property">roles</span> <span class="keyword">as</span> <span class="built_in">any</span>)</span><br><span class="line">    ?.<span class="title function_">getAll</span>()</span><br><span class="line">    ?.<span class="title function_">map</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item.<span class="property">name</span>)</span><br><span class="line">    ?.<span class="title function_">join</span>(<span class="string">&quot;|&quot;</span>);</span><br><span class="line">  item.<span class="property">data</span>.<span class="property">OrgUniqueName</span> = globalCtx.<span class="property">organizationSettings</span>?.<span class="property">uniqueName</span>;</span><br><span class="line">  item.<span class="property">data</span>.<span class="property">Client</span> = globalCtx.<span class="property">client</span>?.<span class="title function_">getClient</span>();</span><br><span class="line">  item.<span class="property">data</span>.<span class="property">ClientState</span> = globalCtx.<span class="property">client</span>?.<span class="title function_">getClientState</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>To have this included in all tracking we can add it with the module…</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">init</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> appins = <span class="keyword">new</span> <span class="title class_">ApplicationInsights</span>(&#123;</span><br><span class="line">    <span class="attr">config</span>: &#123;</span><br><span class="line">      <span class="attr">instrumentationKey</span>: <span class="string">&quot;d5656791-01e1-4d2e-9172-08fd79545a97&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">  appins.<span class="title function_">loadAppInsights</span>();</span><br><span class="line">  appins.<span class="title function_">addTelemetryInitializer</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> globalCtx = <span class="title class_">Xrm</span>.<span class="property">Utility</span>.<span class="title function_">getGlobalContext</span>();</span><br><span class="line">    item.<span class="property">data</span>.<span class="property">Username</span> = globalCtx.<span class="property">userSettings</span>?.<span class="property">userName</span>;</span><br><span class="line">    item.<span class="property">data</span>.<span class="property">UserId</span> = globalCtx.<span class="property">userSettings</span>?.<span class="property">userId</span>;</span><br><span class="line">    item.<span class="property">data</span>.<span class="property">SecurityRoles</span> = (globalCtx.<span class="property">userSettings</span>?.<span class="property">roles</span> <span class="keyword">as</span> <span class="built_in">any</span>)</span><br><span class="line">      ?.<span class="title function_">getAll</span>()</span><br><span class="line">      ?.<span class="title function_">map</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item.<span class="property">name</span>)</span><br><span class="line">      ?.<span class="title function_">join</span>(<span class="string">&quot;|&quot;</span>);</span><br><span class="line">    item.<span class="property">data</span>.<span class="property">OrgUniqueName</span> = globalCtx.<span class="property">organizationSettings</span>?.<span class="property">uniqueName</span>;</span><br><span class="line">    item.<span class="property">data</span>.<span class="property">Client</span> = globalCtx.<span class="property">client</span>?.<span class="title function_">getClient</span>();</span><br><span class="line">    item.<span class="property">data</span>.<span class="property">ClientState</span> = globalCtx.<span class="property">client</span>?.<span class="title function_">getClientState</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">  (<span class="variable language_">window</span> <span class="keyword">as</span> <span class="built_in">any</span>).<span class="property">d365ts_appinsights</span> = appins;</span><br><span class="line">  <span class="keyword">return</span> appins;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>You may even want to add a second telemetry initializer for adding some data from the form context</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">addFormContextTelemetryInitializer</span> = (<span class="params"></span></span><br><span class="line"><span class="params">  formContext: Xrm.BasicPage</span></span><br><span class="line"><span class="params"></span>) =&gt; &#123;</span><br><span class="line">  appInsights.<span class="title function_">addTelemetryInitializer</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">    item.<span class="property">data</span>.<span class="property">EntityName</span> = formContext.<span class="property">data</span>?.<span class="property">entity</span>?.<span class="title function_">getEntityName</span>();</span><br><span class="line">    item.<span class="property">data</span>.<span class="property">EntityId</span> = formContext.<span class="property">data</span>?.<span class="property">entity</span>?.<span class="title function_">getId</span>();</span><br><span class="line">    item.<span class="property">data</span>.<span class="property">FormName</span> = formContext.<span class="property">ui</span>?.<span class="property">formSelector</span></span><br><span class="line">      ?.<span class="title function_">getCurrentItem</span>()</span><br><span class="line">      ?.<span class="title function_">getLabel</span>();</span><br><span class="line">    item.<span class="property">data</span>.<span class="property">FormType</span> = formContext.<span class="property">ui</span>?.<span class="title function_">getFormType</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Now when the form loads we can add the form context initializer</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">addFormContextTelemetryInitializer</span>((formContext <span class="keyword">as</span> <span class="built_in">unknown</span>) <span class="keyword">as</span> <span class="title class_">Xrm</span>.<span class="property">BasicPage</span>);</span><br></pre></td></tr></table></figure>

<h2 id="What’s-it-look-like"><a href="#What’s-it-look-like" class="headerlink" title="What’s it look like!?"></a>What’s it look like!?</h2><p>Ok ok! Here is what all that lovely data will look like in Azure Application Insights…</p>
<p>First we have the results in the transaction search:<br><img src="/2021/04/30/D365-Typescript-Webresources-Part-6/log.png" alt="transaction search"></p>
<p>Then after selecting a result we can see the detail:<br><img src="/2021/04/30/D365-Typescript-Webresources-Part-6/detail.png" alt="End-to-end transaction details"></p>
<p>And there we have it!</p>
<h2 id="That’s-all-folks"><a href="#That’s-all-folks" class="headerlink" title="That’s all folks!"></a>That’s all folks!</h2><p>I hope that has been useful!</p>
<p>You can download a copy of the source code for this blog post <a href="d365ts-pt6.zip">here</a></p>
<p>Thanks for reading.<br>Ollie</p>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/categories/">Categories</a></li>
         
          <li><a href="/archives/">Archive</a></li>
         
          <li><a href="/Me/">Me</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Application-Insights"><span class="toc-number">1.</span> <span class="toc-text">Application Insights</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#What-is-Application-Insights"><span class="toc-number">1.1.</span> <span class="toc-text">What is Application Insights?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Setup"><span class="toc-number">1.2.</span> <span class="toc-text">Setup</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#The-Code"><span class="toc-number">1.3.</span> <span class="toc-text">The Code</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Telemetry-Initializer"><span class="toc-number">1.4.</span> <span class="toc-text">Telemetry Initializer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#What%E2%80%99s-it-look-like"><span class="toc-number">1.5.</span> <span class="toc-text">What’s it look like!?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#That%E2%80%99s-all-folks"><span class="toc-number">1.6.</span> <span class="toc-text">That’s all folks!</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://www.oliverflint.co.uk/2021/04/30/D365-Typescript-Webresources-Part-6/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://www.oliverflint.co.uk/2021/04/30/D365-Typescript-Webresources-Part-6/&text=D365 TypeScript Web Resources - Part 6 - Application Insights"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://www.oliverflint.co.uk/2021/04/30/D365-Typescript-Webresources-Part-6/&title=D365 TypeScript Web Resources - Part 6 - Application Insights"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://www.oliverflint.co.uk/2021/04/30/D365-Typescript-Webresources-Part-6/&is_video=false&description=D365 TypeScript Web Resources - Part 6 - Application Insights"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=D365 TypeScript Web Resources - Part 6 - Application Insights&body=Check out this article: http://www.oliverflint.co.uk/2021/04/30/D365-Typescript-Webresources-Part-6/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://www.oliverflint.co.uk/2021/04/30/D365-Typescript-Webresources-Part-6/&title=D365 TypeScript Web Resources - Part 6 - Application Insights"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://www.oliverflint.co.uk/2021/04/30/D365-Typescript-Webresources-Part-6/&title=D365 TypeScript Web Resources - Part 6 - Application Insights"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://www.oliverflint.co.uk/2021/04/30/D365-Typescript-Webresources-Part-6/&title=D365 TypeScript Web Resources - Part 6 - Application Insights"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://www.oliverflint.co.uk/2021/04/30/D365-Typescript-Webresources-Part-6/&title=D365 TypeScript Web Resources - Part 6 - Application Insights"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://www.oliverflint.co.uk/2021/04/30/D365-Typescript-Webresources-Part-6/&name=D365 TypeScript Web Resources - Part 6 - Application Insights&description=Application Insights, a feature of Azure Monitor, is an extensible Application Performance Management (APM) service for developers and DevOps professionals. Use it to monitor your live applications. In this post I&#39;ll go though the steps required to set it up in your TypeScript Webresources project."><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://www.oliverflint.co.uk/2021/04/30/D365-Typescript-Webresources-Part-6/&t=D365 TypeScript Web Resources - Part 6 - Application Insights"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2020-2026
    Oliver Flint
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/categories/">Categories</a></li>
         
          <li><a href="/archives/">Archive</a></li>
         
          <li><a href="/Me/">Me</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


    <!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-78426300-2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-78426300-2');
    </script>

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'oliverflintblog';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


    <script src='https://storage.ko-fi.com/cdn/scripts/overlay-widget.js'></script>
    <script>
      kofiWidgetOverlay.draw('oliverflint', {
        'type': 'floating-chat',
        'floating-chat.donateButton.text': 'Support me',
        'floating-chat.donateButton.background-color': '#f45d22',
        'floating-chat.donateButton.text-color': '#fff'
      });
    </script>
  </body>
</html>
